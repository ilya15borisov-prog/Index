<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Диктофон с Whisper (без Storage)</title>
    <!-- Firebase SDK (только Auth, без Storage) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js"></script>
    <style>
        /* Стили без изменений */
    </style>
</head>
<body>
    <!-- HTML без изменений -->

    <script>
        // Настройки (замени на свои!)
        const openaiApiKey = 'YOUR_OPENAI_API_KEY';
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Инициализация Firebase
        firebase.initializeApp(firebaseConfig);
        console.log('Firebase инициализирован:', firebase.apps.length); // Отладка
        const auth = firebase.auth();

        // ... остальной код ...

        // Логин с отладкой
        loginBtn.addEventListener('click', async () => {
            console.log('Кнопка войти нажата'); // Отладка
            const email = emailInput.value;
            const password = passwordInput.value;
            try {
                console.log('Попытка входа:', email); // Отладка
                await auth.signInWithEmailAndPassword(email, password);
                authError.textContent = '';
                console.log('Вход успешен'); // Отладка
            } catch (err) {
                console.error('Ошибка входа:', err); // Отладка
                authError.textContent = 'Ошибка входа: ' + err.message;
            }
        });

        // Регистрация с отладкой
        registerBtn.addEventListener('click', async () => {
            console.log('Кнопка регистрация нажата'); // Отладка
            const email = emailInput.value;
            const password = passwordInput.value;
            try {
                console.log('Попытка регистрации:', email); // Отладка
                await auth.createUserWithEmailAndPassword(email, password);
                authError.textContent = '';
                console.log('Регистрация успешна'); // Отладка
            } catch (err) {
                console.error('Ошибка регистрации:', err); // Отладка
                authError.textContent = 'Ошибка регистрации: ' + err.message;
            }
        });

        // Проверка состояния аутентификации
        auth.onAuthStateChanged(currentUser => {
            console.log('Состояние Auth изменилось:', currentUser ? currentUser.email : 'null'); // Отладка
            if (currentUser) {
                user = currentUser;
                loginForm.style.display = 'none';
                app.style.display = 'block';
            } else {
                user = null;
                loginForm.style.display = 'block';
                app.style.display = 'none';
            }
        });

        // ... остальной код без изменений ...
    </script>
</body>
</html>
